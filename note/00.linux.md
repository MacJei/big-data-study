# Linux学习

##  VM与Linux安装

1.安装虚拟机VM12
​	不勾选增强型键盘驱动程序
​	不勾选启动时检查产品更新
​	不勾选用户体验
​	秘钥：5A02H-AU243-TZJ49-GTC7K-3C61N
2.安装Xshell
​	秘钥：150105-116578-999990
3.检查BIOS虚拟化支持
​	Win10：点击任务管理器->性能->右下角，虚拟化可以查看是否开启
​	一般主板：在BIOS Security 选择Virtualization Technology
​	在华硕主板中:高级->cpu设置->intel(VX) Virtualization Technology 开启
4.新建虚拟机：
​	点击创建虚拟机+
​	自定义(高级)
​	安装程序光盘镜像iso，先选择一个镜像文件，这里是centos-6.8
​	选择稍后安装操作系统
​	客户机操作系统：选择Linux，版本：CentOS64位
​	选择处理器数量4，每个核心数量2，总核心数量8
​	内存2048
​	设置网络NAT(表示本台虚拟机对外网不可见，通过windows访问，如果是桥接，则等价于2台独立的电脑访问，虚拟机对外网可见)，在完全装完后，点击网络电脑图标选择System eth0 即可上网
​	选择LSI
​	选择SCSI
​	选择磁盘大小50G，将虚拟机拆分多个文件
​	全部完成之后，点击虚拟机
​	选择CD/DVD，查找到对应的ISO文件
​	开启虚拟机进行安装CentOS，默认第一个安装
​	选择skip
​	在CentOS欢迎页面：
​		 next
​		 选择中文	
​		选择键盘语言：美国英语
​		选择存储设备：基本存储设备
​		选择忽略所有数据
​		给计算机起名字
​		网络环境等安装完成后再配置
​		选择时区：亚洲/上海
​		必要设置root密码
​		硬盘分区：创建自定义布局
​		新建根分区：点击创建->标准分区->创建->挂载点：/;文件系统类型：ext4；大小：48950，固定大小
​		创建Boot分区：点击空闲->标准分区->创建->挂载点：/boot;文件系统类型：ext4；大小：200，固定大小
​		创建swap分区（当内存超过设定值时，使用硬盘分配的swap分区大小作为内存使用，防止宕机）：点击空闲->标准分区->创建->挂载点：不适用；文件系统类型：swap；大小：2048，固定大小
​		下一步->格式化->将修改写入磁盘
​		程序引导：直接下一步
​		定制系统软件：现在自定义，下一步
​		Web服务环境：不选择
​		可扩展文件系统支持：不选择
​		基本系统：兼容程序库，基本
​		应用程序：互联网浏览器
​		其他可以都不勾选，使用时再安装
​		桌面：去除KDE桌面，其他都选
​		语言支持：中文支持
​		系统管理，虚拟化，负载均衡，高可用都可以不选
​		开始安装CentOs，安装完成，点击重新引导
​		欢迎引导页面->前进
​		许可证->同意->前进
​		创建用户：可以不创建
​		时间日期：当前时间日期
​		Kdump去除，不启用
​		重启后登陆
5.安装VMTools
​	是什么？VM的一组工具，用于虚拟化显示和调整，便于和主机交互，如创建共享文件夹，可以直接拖文件到虚拟机中，显示分辨率调整
​	安装：选择虚拟机菜单栏->安装VMwareTools
​		将.tar.gz文件拖拽到桌面
​		右键解压到此处
​		找到vmware-install.pl文件、
​		在终端中打开命令窗口，在解压的文件目录下执行./vmware-install.pl命令运行，依次回车

## Linux文件与目录结构

> Linux一切皆文件

目录结构

- / 根目录
  - **/bin**：binary的缩写，存放最经常使用的命令
  - /sbin：super user的含义，存放着系统管理员使用的系统管理程序
  - **/home**：存放普通用户的主目录，在Linux中每个用户都有一个自己的目录，一般该目录是以用户名账号命名的
  - **/root**：该目录为系统管理员，也是超级权限者用户目录
  - /lib：系统开机所需要的最基本的动态连接共享库，作用类似于windows中的dll文件，几乎所有的程序都用到了这些共享库
  - /lost+found：当系统非法关机后，存放一些文件，一般是空的
  - **/etc**：所有的系统管理所需要的配置文件和子目录
  - **/usr**：用户的应用程序和文件存在在该目录下，类似于windows的program files目录
  - **/boot**：存放系统启动时的核心文件，一些链接文件和镜像文件，一般自定义安装不放在这里
  - /proc：虚拟目录，系统**内存的映射**，通过直接访问该目录获取系统信息
  - /srv：service的缩写，该目录存放一些服务启动之后需要提取的数据
  - /sys：Linux内核2.6中新出现的文件系统sysfs
  - /tmp：存放临时文件
  - /dev：类似于windows的设备管理器，把所有的硬件用文件形式存储
  - **/media**：系统会自动识别一些设备，如U盘，光驱等，识别后挂在到这个目录下
  - **/mnt**：系统提供该目录为了让用户临时挂在别的文件系统的，可以将外部的存储挂在到/mnt上，进入该目录查看内容
  - **/opt**：给主机额外安装软件所存放的目录，如安装一个MySQL就是在该目录下
  - **/var**：目录中存放扩充的文件，习惯将经常修改的文件放在该文件夹下，包括日志文件
  - /selinx：一种安全子系统，可以控制程序只能访问特定的文件




## VI/VIM编辑器

### 是什么

VI是Unix系统和类Unix系统最常用的文本编辑器

VIM是从VI发展而来的文本编辑器，可以给字体颜色，来显示语法是否正确

VI和VM在linux系统下是完全兼容的

### 如何使用

拷贝文件数据作为练习

```shell
[root@stt01 home]# cp /etc/smartd.conf /root
[root@stt01 home]# cd /root
[root@stt01 ~]# vi smartd.conf 
```



#### 一般模式

以vi打开文档直接进入了一般模式（默认），在一般模式下，不要输入:

- 使用 `上下左右` 移动光标

常用语法

| 语法    | 功能                                                         |
| ------- | ------------------------------------------------------------ |
| yy      | **复制**光标当前行，复制之后要粘贴的话再按p                  |
| y4y     | 复制光标当前行往下4行，通用写法--y数字y                      |
| p       | 在当前光标处**粘贴**                                         |
| u       | **撤销**上一步                                               |
| dd      | **删除**光标当前**行**                                       |
| d4d     | 删除含关光标后4行，通用写法--d数字d                          |
| x       | **向后删除**一个字符，相当于del                              |
| X       | **向前删除**一个字符，相当于backspace                        |
| yw      | 复制一个词，光标在单词首字母处复制，规律是光标处字母到下一个空格之间的字符 |
| dw      | 删除光标后的一个词                                           |
| shift+^ | **移动到行头**                                               |
| shift+$ | **移动到行尾**                                               |
| gg      | **移动到页头**                                               |
| G       | **移动到页尾**                                               |
| 4G      | **移动到第四行**，通用写法：数字+G                           |

![1.vi.vim.keyword](img\linux\1.vi.vim.keyword.png)



#### 编辑模式

在一般模式可以进行删除，复制，粘贴动作，如果要编辑文本，需要进入编辑模式

- 按下 i ，I，o，O，a，A，r，R 进入编辑模式
- 进入编辑模式后，左下方会显示INSERT 或者 REPLACE 
- 按下 Esc 回到一般模式

| 按键 | 功能                       |
| ---- | -------------------------- |
| i    | 当前光标前，进入编辑模式   |
| I    | 光标所在的行最前           |
| o    | 当前光标的下一行           |
| O    | 当前光标的上一行           |
| a    | 当前光标后                 |
| A    | 光标所在的行最后           |
| s    | 删除当前字符并进入编辑模式 |
| S    | 删除整行并进入编辑模式     |


#### 命令模式

在一般模式下，输入【:/?】三个字符中的一个，就可以在最下面输入命令

| 命令        | 功能                                                         |
| ----------- | ------------------------------------------------------------ |
| :w          | 保存，:wq! 强制保存退出，:x等同于:wq!                        |
| :q          | 退出，:q! 强制退出                                           |
| :!          | 强制执行                                                     |
| /abc        | **查找**abc，按n查找下一个，N查找上一个，通用写法：/要查找的字符 |
| ?abc        | 同上                                                         |
| :set nu     | 显示标号                                                     |
| :set nonu   | 关闭标号                                                     |
| ZZ          | 没有修改文件之间退出，如果修改了，则保存后退出               |
| :%s/abc/def | 将abc批量替换为def，通用写法：%s/old字符/new字符             |

#### 模式间转换

![1551588870080](img\linux\1.vi.vim3.png)



## 网络配置

安装完虚拟机之后会有2个网卡

### 查看虚拟机IP和网关

点击编辑->虚拟网络编辑器

![1551589472025](img\linux\4.network.png)

查看网关：点击上图的【NAT设置(s)...】，记录当前网关地址

![1551589716888](img\linux\4.network2.png)

查看windows环境中的VMnet8的网络配置，点击VMnet8属性->TCP/IPV4->配置固定IP和DNS

![1551589872687](img\linux\4.network3.png)



### 配置网络IP地址

#### 查看网络配置

命令：ifconfig

```shell
ifconfig

eth0      Link encap:Ethernet  HWaddr 00:0C:29:D1:82:07  
          inet addr:192.168.1.128  Bcast:192.168.1.255  Mask:255.255.255.0
          inet6 addr: fe80::20c:29ff:fed1:8207/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:31630 errors:0 dropped:0 overruns:0 frame:0
          TX packets:11163 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:26171770 (24.9 MiB)  TX bytes:795294 (776.6 KiB)

lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:65536  Metric:1
          RX packets:334 errors:0 dropped:0 overruns:0 frame:0
          TX packets:334 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:24942 (24.3 KiB)  TX bytes:24942 (24.3 KiB)
```

此时的ip是使用DHCP动态获取的，需要改成静态ip

#### 修改IP地址

```shell
vim /etc/sysconfig/network-scripts/ifcfg-eth0

EVICE=eth0 					#接口名称，设备，网卡
HWADDR=00:0C:29:D1:82:07 	#MAC地址
TYPE=Ethernet  				#网络类型
UUID=fa28742b-9453-4009-8074-1f2c21a83305 #随机ID
NM_CONTROLLED=yes
# --------------需要修改项目---------------
ONBOOT=yes					#系统启动时网络接口是否有效（默认no）
BOOTPROTO=static			#IP的配置方式：none引导时不使用协议|static 静态配置|bootp协议|dhcp协议(默认)
IPADDR=192.168.1.100		#IP地址配置
GATEWAY=192.168.1.2			#网关配置
DNS1=114.114.114.114		#DNS 域名解析服务器配置
DNS2=8.8.8.8				#DNS 域名解析服务器配置
```

修改完成后，要重启网络服务

```shell
service network restart
```

如果有报错，则重启系统

```shell
reboot
```

测试，ping一下百度，看网络是否可以连接

```shell
ping www.baidu.com
```

此时再打开ifconfig，可以看到现有配置

#### 配置主机名

查看当前主机名

```shell
hostname
```

如果要修改主机名，那么在network文件中进行修改，并保存退出

```shell
vim /etc/sysconfig/network

NETWORKING=yes
HOSTNAME=stt01.demo # 此处可以进行修改，如修改为hadoop100（由于当前ip配置的是192.168.1.100，故便于记忆，加上100表示ip），注意主机名称不要有下划线
```

打开/etc/hosts 配置hadoop的其他机器的ip对应的名称

```shell
vim /etc/hosts

192.168.1.100 hadoop100
192.168.1.101 hadoop101
192.168.1.102 hadoop102
192.168.1.103 hadoop103
192.168.1.104 hadoop104
192.168.1.105 hadoop105
192.168.1.106 hadoop106
192.168.1.107 hadoop107
192.168.1.108 hadoop108
```

重启设备，重启完成后，查看主机名

配置windows下的hosts

```shell
进入C:\Windows\System32\drivers\etc
添加如下内容
192.168.1.100 hadoop100
192.168.1.101 hadoop101
192.168.1.102 hadoop102
192.168.1.103 hadoop103
192.168.1.104 hadoop104
192.168.1.105 hadoop105
192.168.1.106 hadoop106
192.168.1.107 hadoop107
192.168.1.108 hadoop108
```

## 系统操作

### 关闭防火墙

#### 后台服务状态管理

| 命令            | 功能                                                         |
| --------------- | ------------------------------------------------------------ |
| service start   | 开启服务：<br />service network start 启动网络服务，临时开启，关机之后失效 |
| service stop    | 关闭服务：<br />service network stop 关闭网络服务            |
| service restart | 重启服务：<br />service network restart 重启网络服务         |
| service status  | 查看服务状态：<br />service network status 查看网络服务的状态 <br />service --status-all 查看所有服务的状态 |

查看服务的方法

```shell
cd /etc/init.d
ll
```

#### 设置后台服务的自启配置

> 在服务启动时就生效，不需要每次手动启动，一次配置永久生效

| 命令                    | 功能                                                         |
| ----------------------- | ------------------------------------------------------------ |
| chkconfig               | 查看服务器所有的自启服务配置                                 |
| chkconfig 服务名 off    | 关闭指定服务的自启功能                                       |
| chkconfig 服务名 on     | 开启指定服务的自启功能                                       |
| chkconfig 服务名 --list | 查看服务开机启动的状态<br />示例：chkconfig network --list 查看网络状态 |

#### 防火墙操作

永久操作

```shell
# 查看防火墙状态
chkconfig iptables --list
iptables  0:关闭	1:关闭	2:启用	3:启用	4:启用	5:启用	6:关闭
# 关闭防火墙
chkconfig iptables off
# 再查看防火墙状态
chkconfig iptables --list
iptables  0:关闭	1:关闭	2:关闭	3:关闭	4:关闭	5:关闭	6:关闭
```

临时操作

```shell
# 查看防火墙状态
service iptables status
# 临时关闭防火墙
service iptables stop
```



#### 进程运行级别

从chkconfig查看状态的 0:关闭	1:关闭	2:启用	3:启用	4:启用	5:启用	6:关闭 分别表示Linux的进程的运行级别

开机->bios->/boot->init进程->运行级别->运行级别对应的服务

查看默认级别

```shell
vim /etc/inittab
```

Linux有7中运行级别：常用的级别是3和5

- 级别0：系统停机状态，系统默认运行状态不能设置为0，否则不能正常启动
- 级别1：单用户工作状态，root权限，用于系统维护，禁止远程登录
- 级别2：多用户状态，没有NFS，不支持网络
- 级别3：完全的多用户状态，有NFS，登录后进入控制台命令行模式
- 级别4：系统未使用，保留
- 级别5：X11控制台，登录后进入图形GUI模式
- 级别6：系统正常关闭并重启，默认运行级别不能设置为6，否则不能正常启动



### 关机重启

在Linux系统的大多数服务器上，很少有关机操作

正确的关机操作流程：sync-> shutdown -> reboot -> halt

| 命令                     | 功能                                                         |
| ------------------------ | ------------------------------------------------------------ |
| sync                     | 将数据从内存中同步到硬盘中                                   |
| halt                     | 关闭系统，等同于shutdown -h now 和 poweroff                  |
| reboot                   | 重启，等同于shutdown -r now                                  |
| shutdown [选项] 时间参数 | 选项：<br /> -h = halt 关机<br />-r = reboot 重启<br />参数：<br />now，立刻关机<br />数字，等待多久后关机，单位是分钟 |

Linux为了提高磁盘的读写效率，对磁盘采用了**预读迟写**的操作方式，当保存文件时，Linux核心不是立刻将数据保存到磁盘中，而是先保存到缓冲区，等缓冲区满了再一次性写入磁盘中，这种方式减少IO的开启和关闭，提高了磁盘写入数据的效率，但是如果数据还未写入到磁盘时，系统掉电或者其他宕机，将导致数据的丢失。**sync**命令是指将数据**立刻同步**到磁盘

```shell
# 同步数据
sync
# 重启
reboot
# 关机
halt
# 在2分钟后关机，显示登陆用户在当前屏幕中
shutdown -h 2 'this server will shutdown after 2 mins'
# 立刻关机 等同于halt
shutdown -h now
# 立刻重启 等同于reboot
shutdown -r now
```

### 找回root密码 

见资料中的pdf

### 克隆虚拟机

先关闭要克隆的虚拟机，在VM左操作栏目里的我的计算机->选中要克隆的虚拟机->右键->管理->克隆->下一步->克隆自 虚拟机的当前状态->下一步->创建完整克隆

设置克隆的虚拟机名称和存储位置，然后点击完成

修改克隆后的虚拟机的ip

```shell
vim /etc/udev/rules.d/70-persistent-net.rules
```

![1551599058903](img\linux\5.clone1.png)

将mac地址拷贝，将第一行eth0删除，将第二行的eth1改为eth0。

```shell
vim /etc/sysconfig/network-scripts/ifcfg-eth0
# 修改MAC地址，将刚复制的地址粘贴在HWADDR=字段上
# 修改IP，将IPADDR进行修改，这里修改为 192.168.1.101
```

修改主机名

```shell
vim /etc/sysconfig/network
# 将HOSTNAME该为hadoop101
```

重启服务器reboot

### 使用xshell进行连接登陆操作

打开文件，新建，添加名称和端口号，点击确定，选择刚添加的连接，点击连接，输入用户名root，输入密码，连接虚拟机。



## 基本命令

### 常用快捷键

| 快捷键   | 功能                   |
| -------- | ---------------------- |
| Ctrl+c   | 停止进程               |
| Ctrl+l   | 清屏；彻底清屏是reset  |
| Ctrl+q   | 退出                   |
| tab      | 提示                   |
| 上下键   | 查找执行过的命令       |
| Ctrl+alt | linux和Windows之间切换 |



### 帮助命令

#### man 获取帮助信息

基本语法：man [具体命令，或者配置文件]

显示说明：

| 字段        | 功能                 |
| ----------- | -------------------- |
| NAME        | 命令的名称和单行描述 |
| SYNOPSIS    | 如何使用命令         |
| DESCRIPTION | 命令的描述           |
| EXAMPLES    | 使用命令的例子       |
| SEE ALSO    | 相关主题             |

```shell
# 查看ls的用法
man ls
```

#### help 获取shell内置命令的帮助信息

使用help 可以获得shell的内置命令的帮助信息

基本语法：help [具体的命令]

```shell
# 查看cd的帮助命令
help cd
```



### 文件目录操作

#### pwd 当前工作目录的绝对路径

> 显示当前工作目录的绝对路径
>
> print working directory 打印工作目录

```shell
[root@hadoop100 home]# pwd
/home
```



#### ls 列出目录内容

> 列出目录内容

基本语法

```shell
ls [选项] [目录或者文件]
```
参数说明

| 选项 | 功能                                             |
| ---- | ------------------------------------------------ |
| -a   | 全部文件，连同隐藏文件（开头为. 的文件）罗列出来 |
| -l   | 长数据串列出，包含文件的属性和权限数据           |

```shell
[root@hadoop100 usr]# ls -al
总用量 168
# 每列信息依次是：
# 文件类型与权限 连接数 文件属性 文件属组 文件大小byte 建立与更新时间 名称
drwxr-xr-x.  13 root root  4096 2月  27 07:35 .
dr-xr-xr-x.  25 root root  4096 3月   3 16:17 ..
dr-xr-xr-x.   2 root root 36864 3月   3 04:48 bin
drwxr-xr-x.   2 root root  4096 9月  23 2011 etc
drwxr-xr-x.   2 root root  4096 9月  23 2011 games
drwxr-xr-x.  37 root root  4096 2月  27 07:37 include
dr-xr-xr-x.  32 root root  4096 2月  27 07:47 lib
dr-xr-xr-x. 105 root root 65536 3月   3 04:48 lib64
drwxr-xr-x.  24 root root 12288 3月   3 04:48 libexec
drwxr-xr-x.  12 root root  4096 2月  27 07:35 local
dr-xr-xr-x.   2 root root 12288 3月   3 04:48 sbin
drwxr-xr-x. 215 root root  4096 2月  27 07:40 share
drwxr-xr-x.   4 root root  4096 2月  27 07:35 src
```

```shell
可以使用 ll 代替 ls -al 两者含义相同
```



#### cd 切换目录

> 切换目录
> change directory 

基本语法

```shell
cd [参数]
```
参数说明

| 参数         | 功能                                   |
| ------------ | -------------------------------------- |
| cd 绝对路径  | 切换路径                               |
| cd 相对路径  | 切换路径                               |
| cd ~ 或者 cd | 切换到自己的家目录                     |
| cd -         | 回到上一次所在的目录                   |
| cd ..        | 回到上一级目录                         |
| cd -P [路径] | 跳转到实际的物理路径，非快捷键方式路径 |



#### mkdir 创建一个新目录

> 创建一个新的目录
> make directory 建立一个目录

基本语法

```shell
mkdir [选项] 要创建的目录
```

参数说明

| 参数 | 说明         |
| ---- | ------------ |
| -p   | 创建多层目录 |

```shell
[root@hadoop100 home]# mkdir test01
[root@hadoop100 home]# ll
总用量 4
drwxr-xr-x. 2 root root 4096 3月   6 23:26 test01
[root@hadoop100 home]# mkdir -p test01/test02/test03
```



#### rmdir 删除一个空的目录

> remove directory 删除一个空的目录，注意，目录中没有文件可以删除

```shell
[root@hadoop100 home]# rmdir test01/
rmdir: 删除 "test01/" 失败: 目录非空
```



#### touch 创建空文件

```shell
touch test.txt
```



#### cp 复制文件或目录

基本语法：复制source文件到dest

```java
cp [选项] source dest 
```

选项说明

| 选项 | 功能               |
| ---- | ------------------ |
| -r   | 递归复制整个文件夹 |

参数说明

| 参数   | 功能     |
| ------ | -------- |
| source | 源文件   |
| dest   | 目标文件 |

```shell
# 复制文件
cp test.txt test01/test02/
# 递归复制整个文件夹
cp -r test01 test03
# 强制不提示的方式使用 \cp
```



#### rm 移除文件或目录

基本语法：递归删除目录中的所有内容

```shell
rm [选项] deleteFile
```

选项说明
| 选项 | 功能                                   |
| ---- | -------------------------------------- |
| -r   | 递归删除目录中的所有内容               |
| -f   | 强制执行删除命令，而不提示用户用于确认 |
| -v   | 显示指令的详细过程                     |

```shell
rm test.txt 
rm：是否删除普通空文件 "test.txt"？yes

rm -rfv test03
已删除目录："test03/test02/test02"
已删除"test03/test02/test.txt"
已删除目录："test03/test02"
已删除目录："test03"
```

#### mv 移动文件与目录或重命名

基本语法

```shell
mv oldNameFile newNameFIle #重命名
mv /temp/moveFile /targetFolder # 移动文件
```

#### cat 查看内容

```shell
cat [选项] fileName
选项：
-n 显示所有行号，包括空行
示例：
cat -n houge.txt
```

#### more 文件内容分屏查看

> more 是基于vi编辑器的文本过滤器，以全屏的方式按页显示文本文件的内容

```shell
more fileName
```

操作说明

| 操作   | 功能说明                 |
| ------ | ------------------------ |
| space  | 向下翻页                 |
| enter  | 向下翻一行               |
| Ctrl+f | 向下滚动一屏             |
| Ctrl+b | 向上滚动一屏             |
| =      | 输出当前行的行号         |
| :f     | 输出文件名和当前行的行号 |
| q      | 退出                     |

```shell
[root@hadoop100 ~]# more smartd.conf
```

#### less 分屏显示文件内容

> 用于分屏查看文件内容，与more功能强，less指令在显示文件内容时，不是一次将整个文件加载之后再显示，而是根据需要显示要加载的内容，对于显示大型文件具有较高的效率

```shell
less fileName
```

操作说明

| 操作     | 说明                                       |
| -------- | ------------------------------------------ |
| space    | 向下翻动一页                               |
| pagedown | 向下翻动一页                               |
| pageup   | 向上翻动一页                               |
| /字符串  | 向下搜索“字符串”，n：向下查找；N：向上查找 |
| ?字符串  | 向上搜索“字符串”，n：向上查找；N：向下查找 |
| q        | 退出                                       |

```shell
[root@hadoop100 ~]# less smartd.conf
```

#### echo 输出内容到控制台

```shell
echo [选项] [输出内容]
选项：
-e:开启转义
控制字符：
\\:输出\本身
\n:换行符
\t:制表符，Tab键
\":表示“
\a:发出警告声
\b:删除前一个字符
\f:换行但光标仍旧停留在原来的位置
```

示例

```shell
# 显示字符串
echo “hello world”
hello world
# 可以去除引号
echo hello world
# 显示转义符
echo "\"hello world\""
"hello world"
# 在shell中读取变量名
touch test.sh
# 在test.sh 添加如下内容
read name
echo $name is test echo
# 执行test.sh
sh test.sh
hello world # 输入
hello world is test echo # 输出
# 显示换行
echo "hello \n world"
hello \n world
echo -e "hello \n world"
hello 
 world
# 将结果指定到文件
echo "hello world" > hello.txt
# 显示原始字符串，不进行转义，使用单引号
echo '$name\"'
$name\"
# 显示命令执行的命令
echo `date` # 显示日期
```

#### head 显示文件头部信息

> 用于显示文件开头部分内容，默认情况下显示文件的前10行内容

```shell
head fileName
head -n5 fileName # 显示文件的前5行内容
参数：
-n<num>: 指定显示头部内容的行数
```

#### tail 显示文件尾部信息

> 用于输出文件中尾部的内容，默认情况下显示文件的后10行内容

```shell
tail fileName		# 查看文件后10行内容
tail -n5 fileName	# 查看文件后5行内容
tail -f fileNmae 	# 实时追踪该文档的更新
参数：
-n<num>: 指定显示头部内容的行数
-f：显示文件最新追加的内容，监视文件的变化
```

#### 覆盖 > 与 追加 >>

> 将显示的文本信息写入到文件中

```shell
ls -l > fileName  	# 将列表内容写入到fileName文件中
ls -al >> fileName 	# 将文件内容追加到fileName文件中
cat file1 > file2 	# 将文件1的内容覆盖文件2
echo “content” >> fileName # 将字符串追加到fileName文件中
```

#### ln 软连接

> 符号连接，类似于快捷方式

```shell
ln -s[sourceFile][linkName] # 给原文件创建一个软链接
rm -rf linkName 			# 删除一个软链接，注意不是linkName/ 否则删除软链接下的文件
# 通过ll查看文件属性，第一个属性是l，表示是软链接
```

示例

```shell
>ln -s test01 lntest01
>ll
lrwxrwxrwx. 1 root root    6 3月  12 08:54 lntest01 -> test01
>cd -P lntest01/ # 进入软链接实际的物理路径
>rm -rf lntest01
```

#### history 查看已经执行过历史命令

```shell
>history
```

### 日期时间

```shell
date [option] [format]
选项：
-d<时间字符串> ：显示指定的时间 
date -d'1 days ago' 显示昨天
date -d'-1 days age' 显示明天

-s<日期格式> ：设置系统时间
date -s'2018-08-21 20:00:00'

<+日期时间格式> ：显示指定格式的当前时间
date ：显示当前默认时间格式
date +%Y ：显示当前年份 如2019
date +%y ：显示当前年份 如19
date +%m ：显示当前月份
date +%d ：显示当前是哪一天
date +%D : 显示日期格式是03/21/19
date '+%Y-%m-%d %H:%M-%S' ：显示指定格式的当前时间

cal 查看日历
cal 2019
```

### 用户管理命令

#### useradd 添加用户

```shell
useradd 用户名 #添加用户
useradd -g 组名 用户名 # 添加新用户到某个组

[root@hadoop100 home]# useradd ttshe
[root@hadoop100 home]# ll /home
```

#### passwd 设置密码

```shell
passwd 用户名 #设置密码
```

#### id 查看用户是否存在

```shell
id 用户名
[root@hadoop100 home]# id ttshe
uid=500(ttshe) gid=500(ttshe) 组=500(ttshe)
```



#### cat /etc/passwd 查看创建的用户

```shell
cat /etc/passwd
```



#### su 切换用户

> switch user

```shell
su 用户名 # 切换用户，只能获取用户的执行权限，不能获得环境变量
su - 用户名 # 切换用户并获取环境变量和执行权限

[root@hadoop100 home]# su ttshe
[ttshe@hadoop100 home]$ echo $PATH
/usr/lib64/qt-3.3/bin:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/root/bin
[ttshe@hadoop100 home]$ exit
exit
[root@hadoop100 home]# su - ttshe
[ttshe@hadoop100 ~]$ echo $PATH
/usr/lib64/qt-3.3/bin:/usr/local/bin:/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/sbin:/home/ttshe/bin
```



#### userdel 删除用户

```shell
userdel 用户名 # 删除用户但保存用户的主目录
userdel -r 用户名 # 删除用户和用户主目录 -r 表示删除用户以及与用户相关的所有文件
```



#### who 查看登录用户信息

```shell
whoami # 显示自身用户名称
who am i # 显示登录用户的用户名

[ttshe@hadoop100 ~]$ whoami
ttshe
[ttshe@hadoop100 ~]$ who am i
root     pts/0        2019-03-21 21:44 (192.168.1.1)
```



#### sudo 设置用户具有root权限

> 给普通用户附上root的权限，每次执行时使用sudo命令

```shell
# 先创建用户ttshe
useradd ttshe
# 设置密码
passwd ttshe
# 修改配置文件 在第91行
vim /etc/sudoers

 90 ## Allow root to run any commands anywhere 
 91 root    ALL=(ALL)       ALL
 92 ttshe   ALL=(ALL)       ALL # NOPASSWD:ALL 如果设置没有密码，那么在使用sudo时，不用输入密码

# 使用sudo进行操作
[root@hadoop100 ttshe]# su ttshe
[ttshe@hadoop100 home]$ mkdir test03
mkdir: 无法创建目录"test03": 权限不够
[ttshe@hadoop100 home]$ sudo mkdir test03
# 使用sudo 在输入密码后，可以执行成功 如果要查看某些问题件
[ttshe@hadoop100 home]$ useradd ttshe2
bash: /usr/sbin/useradd: 权限不够
[ttshe@hadoop100 home]$ sudo useradd ttshe2
[ttshe@hadoop100 home]$ ls -l ttshe2
ls: 无法打开目录ttshe2: 权限不够
[ttshe@hadoop100 home]$ sudo ls -l ttshe2
总用量 0
```



#### usermod 修改用户

```shell
usermod -g 用户组 用户名
# -g 修改用户的初始登录组，给定的组必须存在
[root@hadoop100 home]# usermod -g root ttshe
[root@hadoop100 home]# id ttshe
uid=500(ttshe) gid=0(root) 组=0(root)
```



### 用户组管理命令

> 每个用户都有一个用户组，系统对一个用户组中的所有用户进行集中管理
> 不同的系统对用户组的规定有所不同
> Linux下的用户属于与它同名的用户组，用户组在创建用户时同时创建
> 用户组的管理，实际上是对/etc/group文件的更新

#### groupadd 新增组

```shell
groupadd mygroup
```

#### cat /etc/group 查看所有组信息

```shell
[root@hadoop100 home]# cat /etc/group
ttshe2:x:501:
mygroup:x:502:
```

#### groupdel 删除组

```shell
groupdel mygroup
```

#### groupmod 修改组

```shell
groupmod -n 新组名 旧组名
# -n<新组名> 
```



### 文件权限

#### 文件属性

> 不同的用户有不同的权限，Linux系统对不同的用户访问同一个文件的权限有不同的规定

| 文件类型                                                     | 属主权限(U user)               | 属组权限(G group)              | 其他用户权限(O other)    |
| ------------------------------------------------------------ | ------------------------------ | ------------------------------ | ------------------------ |
| 0                                                            | 1   2   3                      | 4   5   6                      | 7   8   9                |
| d                                                            | r   w   x                      | r    -    x                    | r    -   x               |
| 目录文件                                                     | 读 写 执行                     | 读 写 执行                     | 读  写  执行             |
| 代表这个文件是目录，文件，或者链接文件<br />- 代表文件<br />d代表目录<br />l 链接文档 link file | 确定属主，该文件的所有者的权限 | 所有者同组用户拥有该文件的权限 | 其他用户拥有该文件的权限 |
|                                                              |                                |                                |                          |

如果没有权限，使用减号代替

**rwx 作用文件和目录的不同解释**

- 作用到文件
  - r 
    - read代表可读：可以读取查看、
  - w
    - w 代表可写：可以修改但是不代表可以删除文件，删除一个文件的前提是对该文件所在目录有写权限
  - x
    - execute 代表可以执行：可以被系统执行

- 作用到目录

  - r
    - 可以读取，ls查看目录内容
  - w
    - 可以修改，目录内创建+删除+重命名
  - x
    - 可以执行，可以进入该目录

![1553520781316](img\linux\6.rwx1.png)

**链接数**

- 如果是文件，指的是硬链接个数

  - 创建硬链接方法`ln[源文件][目标文件]`

- 如果查看的是文件夹，链接个数指的是子文件夹个数

  

#### chmod 改变权限

u- 所有者，g-所在的组，o-其他人，a-所有人

- 方式1

```shell
chmod [{ugoa}{+-=}{rwx}][文件或目录]

+表示增加一个权限
-表示删除一个权限
=表示等于一个权限

示例：
[root@hadoop100 test01]# ll
总用量 4
drwxr-xr-x. 3 root root 4096 3月  11 22:35 test03
[root@hadoop100 test01]# chmod g+w test03/
[root@hadoop100 test01]# ll
总用量 4
drwxrwxr-x. 3 root root 4096 3月  11 22:35 test03
[root@hadoop100 test01]# chmod u-x,o+w test03/
[root@hadoop100 test01]# ll
总用量 4
drw-rwxrwx. 3 root root 4096 3月  11 22:35 test03
```

- 方式2

```shell
chmod [mode=421][文件或目录]

示例：mode的值为7表示rwx，6表示rw，5表示rx,4表示r，3表示wx，2表示w，1表示x
[root@hadoop100 test03]# ll
总用量 4
drwxr-xr-x. 3 root root 4096 3月  11 22:21 test02
[root@hadoop100 test03]# chmod 777 test02/
[root@hadoop100 test03]# ll
总用量 4
drwxrwxrwx. 3 root root 4096 3月  11 22:21 test02

注意：如果要对文件夹里面的所有文件的属性与当前目录权限保持一致，可以使用-R
chmod -R 777 test02/
```

#### chown 改变所有者

> 改变文件或者目录的所有者

```shell
chown [选项][最终用户][目录或者文件]
选项：-R 递归操作

[root@hadoop100 test03]# ll
总用量 4
drwxr-xr-x. 3 root root 4096 3月  11 22:21 test02
[root@hadoop100 test03]# chown ttshe test02/
[root@hadoop100 test03]# ll
总用量 4
drwxr-xr-x. 3 ttshe root 4096 3月  11 22:21 test02
[root@hadoop100 test03]# chown root:ttshe test02/
[root@hadoop100 test03]# ll
总用量 4
drwxr-xr-x. 3 root ttshe 4096 3月  11 22:21 test02
# 使用分号用于区分最终用户和最终组
```

#### chgrp 改变所属组

```shell
chgrp [最终用户组][文件或目录]
```

### 搜索查找类

#### find 查找文件或者目录

> 从指定的目录下递归遍历各个子目录，将满足条件的文件显示在终端

```shell
find [搜索范围][选项]

选项说明：
-name<查询方式> 
	按照指定的文件名查找文件
-user<用户名>
	查找属于指定用户名所有文件
-size<文件大小>
	按照指定的文件大小查找文件

[root@hadoop100 test01]# find test03/ -name "*.txt"
test03/test02/test.txt
[root@hadoop100 test01]# find test03/ -user root
test03/
test03/test02
test03/test02/test02
test03/test02/test.txt
[root@hadoop100 test01]# find test03/ -size -100
test03/
test03/test02
test03/test02/test02
test03/test02/test.txt
# +n表示size大于n的文件，-n表示size小于n的文件 n表示等于
```

#### grep 过滤查找

> 管道符 | ，表示将前一个命令的处理结果输出传递给后面的命令处理

```shell
grep 选项 查找内容 源文件
选项：
-n
	表示匹配行以及行号
	
示例：查找te打头的文件以及所在ls结果的行数
[root@hadoop100 home]# ls | grep -n te
2:lntest01
3:test01
4:test02.txt
5:test03
6:test.sh
```

#### which 查找命令

> 查找命令在哪个目录下

```shell
[root@hadoop100 home]# which ll
alias ll='ls -l --color=auto'
	/bin/ls
```

### 压缩和解压

#### gzip/gunzip 压缩

> 只能压缩文件不能压缩目录，不保留原来的文件

```shell
gzip 文件
	压缩文件，将文件压缩为*.gz格式
gunzip 文件.gz
	解压缩文件命令
示例：
[root@hadoop100 test01]# gzip test03/
gzip: test03/ is a directory -- ignored
[root@hadoop100 test02]# ll
总用量 4
drwxr-xr-x. 2 root root 4096 3月   6 23:31 test02
-rw-r--r--. 1 root root    0 3月  11 22:21 test.txt
[root@hadoop100 test02]# gzip test.txt 
[root@hadoop100 test02]# ll
总用量 8
drwxr-xr-x. 2 root root 4096 3月   6 23:31 test02
-rw-r--r--. 1 root root   29 3月  11 22:21 test.txt.gz
[root@hadoop100 test02]# gunzip test.txt.gz 
[root@hadoop100 test02]# ll
总用量 4
drwxr-xr-x. 2 root root 4096 3月   6 23:31 test02
-rw-r--r--. 1 root root    0 3月  11 22:21 test.txt
```

#### zip/unzip 压缩

> 该命令在linux和windows都通用，压缩目录并保留原文件

```shell
zip [选项] xxx.zip 要压缩的内容 
	压缩文件和目录
选项：
-r	压缩目录
	
unzip [选项] xxx.zip
	解压文件
选项：
-d<目录>	指定解压后文件的存放目录
	
示例：
[root@hadoop100 test02]# ll
总用量 4
drwxr-xr-x. 2 root root 4096 3月   6 23:31 test02
-rw-r--r--. 1 root root    0 3月  11 22:21 test.txt
[root@hadoop100 test02]# zip mytest.zip test02/ test.txt
  adding: test02/ (stored 0%)
  adding: test.txt (stored 0%)
[root@hadoop100 test02]# ll
总用量 8
-rw-r--r--. 1 root root  308 3月  25 22:59 mytest.zip
drwxr-xr-x. 2 root root 4096 3月   6 23:31 test02
-rw-r--r--. 1 root root    0 3月  11 22:21 test.txt
[root@hadoop100 test02]# unzip mytest.zip -d /home/ziptest
Archive:  mytest.zip
   creating: /home/ziptest/test02/
 extracting: /home/ziptest/test.txt
 # 如果不指定文件夹，那么在当前文件夹下解压
```

#### tar 打包压缩

```shell
tar [选项] xxx.tar.gz 将要打包的内容

选项
-z	打包的同时压缩
-c	产生.tar 打包文件
-v 	显示详细信息
-f	指定压缩后的文件名
-x 	解压.tar文件

示例：压缩多个文件
[root@hadoop100 ziptest]# tar -zcvf mytar.tar.gz test02/ test.txt 
test02/
test.txt
[root@hadoop100 ziptest]# ls
mytar.tar.gz  test02  test.txt
示例：解压到当前目录
[root@hadoop100 ziptest]# tar -zxvf mytar.tar.gz 
示例：解压到指定目录
[root@hadoop100 ziptest]# tar -zxvf mytar.tar.gz -C /home/tartest
```

### 磁盘分类

#### df 查看磁盘空间使用情况

> disk free 剩余磁盘，列出系统的整体磁盘的使用量，检查文件系统的磁盘空间占用情况

```shell
df 选项
选项：
-h 	以GBytes，MBytes，KBytes显示

示例：
[root@hadoop100 tartest]# df -h
Filesystem      Size  Used Avail Use% Mounted on
/dev/sda2        15G  3.6G   11G  26% /
tmpfs           996M   72K  996M   1% /dev/shm
/dev/sda1        93M   39M   50M  44% /boot
```

#### fdisk 查看分区

该命令在root用户下使用

```shell
fdisk -l 
选项：
-l	显示所有硬盘的分区情况
	
示例：
[root@hadoop100 tartest]# fdisk -l

Disk /dev/sda: 21.5 GB, 21474836480 bytes
255 heads, 63 sectors/track, 2610 cylinders
Units = cylinders of 16065 * 512 = 8225280 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disk identifier: 0x000e985b

   Device Boot      Start         End      Blocks   Id  System
/dev/sda1   *           1          13      102400   83  Linux
Partition 1 does not end on cylinder boundary.
/dev/sda2              13        1972    15728640   83  Linux
/dev/sda3            1972        2233     2097152   82  Linux swap / Solaris
```
Linux分区：
- Device：分区序列
- Boot：引导
- Start：从X磁柱开始
- End：到Y磁柱结束
- Id：分区类型id	
- System：分区类型

#### mount/umount 挂载/卸载

> 在Linux中，每个分区都是用来组成整个文件系统的一部分，使用挂载的处理方法，整个系统包含一整套文件和目录，将一个分区和一个目录联系起来。要载入的那个分区将使它的存储空间在整个目录下获得

```shell
mount [-t vfstype][-o options] device dir
	挂载设备
umount 设备名称或挂载点
	卸载设备

参数：
-t vfstype 
	指定文件系统的类型，通常不用指定，mount会自动选择正确的类型
	常用类型：
		光盘或光盘镜像：iso9660
		DOS fat16文件系统 msdos
		Windows 9x fat32 文件系统 vfat
		Windows NT ntfs 文件系统 ntfs
		Mount Windows 文件网络共享 smbfs
		UNIX(LINUX) 文件网络共享 nfs
-o options
	主要用来描述设备或档案的挂接方式
	loop 把一个文件当成银盘分区挂接上系统
	ro 采用只读的方式挂接设备
	rw 采用读写的方式挂接设备
	iocharset 指定访问文件系统所用字符集
device	要挂接的设备 mount
dir		设备在系统上的挂节点 mount point

示例：挂载光盘镜像文件
[root@hadoop100 home]# mount -t iso9660 /dev/cdrom /home/cdrom
mount: block device /dev/sr0 is write-protected, mounting read-only
[root@hadoop100 home]# cd cdrom/
[root@hadoop100 cdrom]# ll
总用量 558
-r--r--r--. 2 root root     14 5月  22 2016 CentOS_BuildTag
dr-xr-xr-x. 3 root root   2048 5月  22 2016 EFI
-r--r--r--. 2 root root    212 11月 27 2013 EULA
-r--r--r--. 2 root root  18009 11月 27 2013 GPL
dr-xr-xr-x. 3 root root   2048 5月  23 2016 images
...
# 卸载
[root@hadoop100 home]# umount /home/cdrom/
```

设置开机自动挂载

```shell
vi /etc/fstab
# 添加第16行
...
14 sysfs                   /sys                    sysfs   defaults        0 0
15 proc                    /proc                   proc    defaults        0 0
16 /dev/cdrom              /home/cdrom             iso9660 defaults        0 0
```



### 进程线程网络

> 进程是正在执行的一个程序或命令，每个进程都是一个运行的实体，都有自己的**地址空间**，占用一定的系统资源

#### ps 查看当前进程状态

> process status 

##### ps aux 查看所有进程

```shell
ps aux | grep xxx 
	查看系统中的所有进程
选项：
-a 选择所有进程
-u 显示所有用户的所有进程
-x 显示没有终端的进程

示例：
[root@hadoop100 home]# ps aux
USER        PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
root          1  0.0  0.0  19344  1552 ?        Ss   Mar10   0:01 /sbin/init
root          2  0.0  0.0      0     0 ?        S    Mar10   0:00 [kthreadd]
root          3  0.0  0.0      0     0 ?        S    Mar10   0:00 [migration/0]
root          4  0.0  0.0      0     0 ?        S    Mar10   0:00 [ksoftirqd/0]
....

说明：
USER 	该进程是由哪个用户产生的
PID		进程的ID号
%CPU	该进程占用CPU资源百分比
%MEM	占用物理内存百分比
VSZ		占用虚拟内存大小，单位KB
RSS 	占用实际物理内存大小，单位KB
TTY		进程是哪个终端中运行的，tty1-tty7 代表本地控制台，tty1-tty6代表本地字符界面终端，tty7是图形终端，pts/0-255代表虚拟终端
STAT	进程状态，R 运行 S 睡眠 T 停止状态 s 包含子进程 + 位于后台
START	进程的启动时间
TIME	进程占用CPU运算时间，不是系统时间
COMMAND	产生此进程的命令
```

##### ps  -ef 父子进程的关系

```shell
ps -ef | grep xxx
	查看子父进程之间的关系
示例：
[root@hadoop100 home]# ps -ef
UID         PID   PPID  C STIME TTY          TIME CMD
root          1      0  0 Mar10 ?        00:00:01 /sbin/init
root          2      0  0 Mar10 ?        00:00:00 [kthreadd]
root          3      2  0 Mar10 ?        00:00:00 [migration/0]
root          4      2  0 Mar10 ?        00:00:00 [ksoftirqd/0]
....

说明：
UID		用户ID
PID		进程ID
PPID	父进程ID
C		CPU用于计算执行优先级的因子，值越大，说明进程是CPU密集型运算，执行优先级会降低；值越小，说明进程是IO密集型运算，优先级会提高
STIME	进程启动时间
TTY		完整的终端名称
TIME	CPU时间
CMD		启动进程所有的命令和参数
```

#### kill 终止进程

```shell
kill [选项] 进程号
	通过进程号杀死进程
	选项：-9 表示强迫进程立刻终止
	
killall 进程名称
	通过进程名称杀死进程，支持通配符
	
示例：
kill -9 5553
killall firefox
```

#### pstree 查看进程树

```shell
pstree [选项]
说明：
-p 显示进程的PID
-u 显示进程所属的用户
示例：
[root@hadoop100 home]# pstree -p
init(1)─┬─ManagementAgent(2002)─┬─{ManagementAgen}(2019)
        │                       └─{ManagementAgen}(2021)
        ├─NetworkManager(2342)
        ├─VGAuthService(1878)
        ├─abrtd(2785)
        ├─acpid(2457)
        ├─atd(2812)
        ├─auditd(2222)───{auditd}(2223)
        ├─automount(2546)─┬─{automount}(2547)
        │                 ├─{automount}(2548)
        │                 ├─{automount}(2551)
....
[root@hadoop100 home]# pstree -u
init─┬─ManagementAgent───2*[{ManagementAgen}]
     ├─NetworkManager
     ├─VGAuthService
     ├─abrtd
     ├─acpid
     ├─atd
     ├─auditd───{auditd}
....
```

#### top 查看系统健康状态

```shell
top [选项]
选项：
-d 秒数	指定top命令每隔几秒更新，默认3s
-i		 不显示任务号闲置或者僵死的进程
-p 		 通过指定监控进程ID的进程
	
操作说明：在输入top后，可以输入如下命令
P	以CPU使用率排序，默认
M	以内存使用率排序
N	以PID排序
q	退出top

示例：
top - 21:30:15 up 16 days,  1:34,  3 users,  load average: 0.00, 0.01, 0.05
Tasks: 237 total,   1 running, 236 sleeping,   0 stopped,   0 zombie
Cpu(s):  0.0%us,  0.1%sy,  0.0%ni, 99.9%id,  0.0%wa,  0.0%hi,  0.0%si,  0.0%st
Mem:   2038376k total,   906052k used,  1132324k free,   153668k buffers
Swap:  2097148k total,        0k used,  2097148k free,   469900k cached

PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND                
1 root      20   0 19344 1552 1232 S  0.0  0.1   0:01.61 init                    
2 root      20   0     0    0    0 S  0.0  0.0   0:00.01 kthreadd  
...

说明：
第一行：任务队列信息
21:30:15			系统当前时间
up 16 days, 1:34 	系统的运行时间，已经运行1天13小时32分钟
3 users				当前登陆了3个用户
load average:0.00,0.01,0.05 系统在之前1分钟，5分钟，15分钟的平均负载，一般认为小于1，负载较小，如果大于1，系统超出负荷

第二行：进程信息
Tasks：237total 	    系统中的进程总数
1 running			 正在运行的进程数
236 sleeping	     睡眠的进程
0 stopped			 正在停止的进程
0 zombie			 僵尸进程，如果不是0，需要手动检查僵尸进程

第三行：cpu信息
0.0%us		 		用户模式占用的CPU百分比
0.1%sy				系统模式占用的cpu百分比
0.0%ni				改变过优先级的用户进程占用的cpu百分比
99.9%id				空闲cpu的百分比
0.0%hi				硬中断请求服务占用的cpu百分比
0.0%si				软终端请求服务占用的cpu百分比
0.0%st				st steal time 虚拟时间百分比，当有虚拟机的时候，虚拟cpu等待实际cpu的时间百分比

第四行：物理内存
2038376k total		物理内存总量，KB
906052k used		已使用物理内存的数量
1132324k free		空闲的物理内存数量
153668k buffers 	作为缓冲的内存数据量

第五层：交换分区信息
2097148k total 		虚拟内存总大小
0k used				已使用的交互分区大小
2097148k free		空闲的交换分区大小
469900k cached		作为缓冲的交互分区大小

```

关于安装htop

```shell
1.下载
[root@hadoop100 home]# wget http://sourceforge.net/projects/htop/files/htop/1.0.2/htop-1.0.2.tar.gz
2.解压安装
tar -xvf htop-1.0.2.tar.gz
切换到对应的目录下
cd htop-1.0.2
./configure && make && make install
3.报错：configure: error: missing libraries: libncurses
yum install ncurses-devel
4.重新安装
[root@hadoop100 htop-1.0.2]# ./configure && make && make install
```





#### netstat 网络端口信息

```shell
netstat -anp | grep 进程号
	查看该进程网络信息
netstat -nlp | grep 端口号
	查看该网络端口号占用情况
	
选项：
-a	查看所有
-t	查看tcp
-u	查看udp
-n	拒绝显示别名，可以显示数字的全部转化为数字
-l	只列出在listen的服务
-p	表示显示哪个进程在调用
```



### 定时服务

#### crond 服务管理

```shell
# 服务启动
[root@hadoop100 ~]# service crond restart
```

#### crontab 定时任务设置

```shell
crontab [选项]

选项：
-e 	编辑crontab定时任务
-l	查询crontab任务
-r	删除当前用户所有的crontab任务

示例：编辑crontab
[root@hadoop100 ~]# crontab -e
#进入crontab的编辑页面，使用vim进行编辑

使用cron表达式+命令
* * * * * 执行的任务命令
说明：
第一个* 	一小时当中的第几分钟 0-59
第二个*	一天当中的第几个小时 0-23
第三个* 	一个月当中第几天	1-31
第四个*	一年当中第几个月	1-12
第五个*	一周当中星期几		 0-7(0和7都表示周日)

特殊符号：
* 	 	 表示任何时间，如第一个*就表示一小时中，每分钟都执行一次
， 	    表示不连续的时间，如"0 8,16,20 * * *"，表示每日8点，16点。20点执行一次
- 		 表示连续的时间范围，如"0 5 * * 1-6"，表示周一到周六每日5点执行一次
*/n		 表示每隔多久执行一次，如"*/10 * * * *"，表示每隔10分钟执行一次

cron表达式示例：
45 22 * * * 	每日22点45分执行
0 17 * * 1		每周一17点执行
0 5 1,15 * *	每个月1号，15号，5点执行
40 4 * * 1-5	周一到周五4点40执行
*/10 4 * * *	每日4点每10分钟执行一次
0 0 1,15 * 1	每个月1号，15号，周一，0点都执行，注意：星期和几号不要同时出现，容易混乱

示例：在crontab中添加，每一分钟，向/home/test01.txt 输出22数字
*/1 * * * * /bin/echo "22">>/home/test01.txt
```



## 软件包管理



### RPM 

> RedHat Package Manager 红帽软件管理工具，类似于windows中的setup.exe，是Linux系统的打包安装工具

RPM 的名称格式

Apache-1.3.23-11.i386.rpm

- Apache		软件名称
- -1.3.23-11	   软件的版本号，主版本和此版本
- -i386		    是软件的硬件平台
- rpm		     文件扩展名，代表RPM包



#### RPM 查询命令

```shell
rpm -qa
	查询所安装的rpm软件包，由于安装的比较多，一般使用rpm -a | grep xxx 进行过滤
```



#### RPM 卸载命令

```shell
rpm [选项] xxx
	
选项：
-e 			卸载软件包
--nodeps	卸载软件时不检查依赖，会导致有些软件依赖该卸载软件而不能使用
```



#### RPM 安装命令

```shell
rpm 选项 xxx
选项：
-i 		install 安装
-v 		verbose 显示详细信息
-h		hash 进度条
--nodeps	不检测依赖进度
示例：
rpm -ivh firefox-45.0.1-1.el6.centos.x86_64.rpm
```



### YUM 

> Yellow dog updater Modified，基于RPM包管理，可以从指定的服务器自动下载RPM包并安装，**自动处理依赖性关系**，一次安装所有依赖的包，类似于java的maven工具



#### 常用命令

```shell
yum [选项][参数]
选项：
-y 			对所有的提问都是yes
参数：
install 	安装rpm软件包
update		更新rpm软件包
check-update	检查是否有可更新的rpm软件包
remove		删除指定的rpm软件包
list		显示软件包信息
clean		清理yum过期的缓存
deplist		显示yum软件包的所有依赖关系
```



#### 修改YUM源

设置国内镜像

```shell
1.备份系统自带yum源配置文件
[root@hadoop100 home]# mv /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOs-Base.repo.backup
2.进入yum源配置文件所在文件夹
[root@hadoop100 home]# cd /etc/yum.repos.d/
3.下载163的yum源配置文件到该文件夹下
[root@hadoop100 yum.repos.d]# wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-6.repo
4.更新缓存 可以先yum clean all
[root@hadoop100 yum.repos.d]# yum makecache
#5.更新软件包 如果没有需要可以不升级 升级所有软件
#yum -y update
```



#### 安装软件

- 安装rz sz命令，用于上传下载使用

```shell
yum -y install lrzsz 
```



## 面试问题

Linux查看内存、磁盘存储、io 读写、端口占用、进程等命令
1、查看内存：top
2、查看磁盘存储情况：df -h
3、查看磁盘IO读写情况：iotop（需要安装一下：yum install iotop）、iotop -o（直接查看输出比较高的磁盘读写程序）
4、查看端口占用情况：netstat -tunlp | grep 端口号
5、查看进程：ps aux

